- summarize = false if summarize.nil?

- person_id = "person_#{item.id}"
%li{:id => person_id}
  .personal
    .cv-section.first-cv-section.fixed
      = render :partial => 'person', :object => item
      = render :partial => 'contact', :object => item

    .cv-section.fixed
      %h2.cv-section-name Professional Profile
      .cv-section-items
        = render :partial => 'profile', :object => item

  - if current_user
    %ul.options
      - if !current_page?(item) and permitted_to? :read, item
        %li= link_to 'View person', item
      - if permitted_to? :update, item
        %li= link_to 'Edit person', edit_person_path(item), :class => 'remote-link', :title => 'Edit person'
      - if permitted_to? :delete, item
        %li= link_to 'Delete person', delete_person_path(item), :class => 'remote-link', :title => 'Delete person'

    - content_for :javascript do
      = dynamic_on_ready_tooltip_javascript_for "##{person_id} > .personal", 'top right'

  - elsif !current_page?(item) and permitted_to? :read, item
    %ul.options
      %li= link_to 'View person', item

  - unless summarize
    .cv-section.fixed.companies
      %h2.cv-section-name Work Experience
      .cv-section-items

        - companies_id = "person_#{item.id}_companies"
        %ul{:id => companies_id}
          = render :partial => 'companies/item', :collection => item.companies

    - if current_user
      %ul.options
        - if permitted_to? :create, :companies
          %li= link_to 'New company', new_person_company_path(item), :class => 'remote-link', :title => 'New company'

      - content_for :javascript do
        = dynamic_on_ready_tooltip_javascript_for '.companies', 'top left'

    .cv-section.fixed.skills
      %h2.cv-section-name Technical Skills
      .cv-section-items

        - skills_id = "person_#{item.id}_skills"
        %ul{:id => skills_id}
          = render :partial => 'skills/item', :collection => item.skills, :locals => {:skill_count => item.skills.count}

        - if current_user and permitted_to? :reposition, :skills
          - content_for :javascript do
            = sortable_javascript_for "##{skills_id}", 'li', "&person_id=#{item.id}", reposition_person_skills_url(item)

    - if current_user
      %ul.options
        - if permitted_to? :create, :skills
          %li= link_to 'New skill', new_person_skill_path(item), :class => 'remote-link', :title => 'New skill'

      - content_for :javascript do
        = dynamic_on_ready_tooltip_javascript_for '.skills', 'top left'

    .cv-section.last-cv-section.fixed.schools
      %h2.cv-section-name Education
      .cv-section-items

        - schools_id = "person_#{item.id}_schools"
        %ul{:id => schools_id}
          = render :partial => 'schools/item', :collection => item.schools

    - if current_user
      %ul.options
        - if permitted_to? :create, :schools
          %li= link_to 'New school', new_person_school_path(item), :class => 'remote-link', :title => 'New school'

      - content_for :javascript do
        = dynamic_on_ready_tooltip_javascript_for '.schools', 'top left'

